import{_ as c}from"./updocker-yVuyGOuG.js";import{_ as p,r,o as u,c as h,b as e,e as a,a as l,w as t,f as i}from"./app-FZZ1a_-5.js";const m={},g=i(`<h1 id="use-docker" tabindex="-1"><a class="header-anchor" href="#use-docker" aria-hidden="true">#</a> Use Docker</h1><h2 id="install" tabindex="-1"><a class="header-anchor" href="#install" aria-hidden="true">#</a> Install</h2><h4 id="docker-cli" tabindex="-1"><a class="header-anchor" href="#docker-cli" aria-hidden="true">#</a> <strong>docker cli</strong></h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--restart</span><span class="token operator">=</span>unless-stopped <span class="token parameter variable">-v</span> /etc/alist:/opt/alist/data <span class="token parameter variable">-p</span> <span class="token number">5244</span>:5244 <span class="token parameter variable">-e</span> <span class="token assign-left variable">PUID</span><span class="token operator">=</span><span class="token number">0</span> <span class="token parameter variable">-e</span> <span class="token assign-left variable">PGID</span><span class="token operator">=</span><span class="token number">0</span> <span class="token parameter variable">-e</span> <span class="token assign-left variable">UMASK</span><span class="token operator">=</span>022 <span class="token parameter variable">--name</span><span class="token operator">=</span><span class="token string">&quot;alist&quot;</span> xhofe/alist:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="docker-compose" tabindex="-1"><a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a> <strong>docker compose</strong></h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.3&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">alist</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&#39;xhofe/alist:beta&#39;</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> alist
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&#39;/etc/alist:/opt/alist/data&#39;</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&#39;5244:5244&#39;</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> PUID=0
      <span class="token punctuation">-</span> PGID=0
      <span class="token punctuation">-</span> UMASK=022
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="env" tabindex="-1"><a class="header-anchor" href="#env" aria-hidden="true">#</a> <strong>Env</strong></h4>`,7),v=e("thead",null,[e("tr",null,[e("th",{style:{"text-align":"left"}},"Name"),e("th",{style:{"text-align":"left"}},"Default"),e("th",null,"Desc")])],-1),b=e("tr",null,[e("td",{style:{"text-align":"left"}},[e("code",null,"PUID")]),e("td",{style:{"text-align":"left"}},[e("code",null,"0")]),e("td",null,"User UID")],-1),f=e("tr",null,[e("td",{style:{"text-align":"left"}},[e("code",null,"PGID")]),e("td",{style:{"text-align":"left"}},[e("code",null,"0")]),e("td",null,"User GID")],-1),k=e("td",{style:{"text-align":"left"}},[e("code",null,"UMASK")],-1),x=e("td",{style:{"text-align":"left"}},[e("code",null,"022")],-1),y={href:"https://en.wikipedia.org/wiki/Umask",target:"_blank",rel:"noopener noreferrer"},_=e("tr",null,[e("td",{style:{"text-align":"left"}},[e("code",null,"RUN_ARIA2")]),e("td",{style:{"text-align":"left"}}),e("td",null,[a("Whether to run ARIA2 concurrently, default is "),e("code",null,"true"),a(" if aria2 is pre-installed, otherwise it is "),e("code",null,"false"),a(".")])],-1),w=e("tr",null,[e("td",{style:{"text-align":"left"}},[e("code",null,"TZ")]),e("td",{style:{"text-align":"left"}}),e("td",null,[a("Default is the UTC time zone. If you want to specify a time zone, you can set this variable, for example: "),e("code",null,"Asia/Shanghai"),a(".")])],-1),I=e("h4",{id:"image-versions",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#image-versions","aria-hidden":"true"},"#"),a(),e("strong",null,"Image Versions")],-1),A=e("p",null,[a("Stable version: "),e("code",null,"xhofe/alist:latest"),a(" or specify a specific version, such as "),e("code",null,"xhofe/alist:v3.41.0"),a(),e("code",null,"xhofe/alist:v3.40.0")],-1),D={href:"https://hub.docker.com/r/xhofe/alist/tags",target:"_blank",rel:"noopener noreferrer"},S=i(`<p>Dev version: <code>xhofe/alist:beta</code></p><p>Pre-installed environment image suffix:</p><table><thead><tr><th style="text-align:left;">Suffix</th><th>Desc</th></tr></thead><tbody><tr><td style="text-align:left;"><code>aio</code></td><td>An image that includes all of the following pre-installed environments.</td></tr><tr><td style="text-align:left;"><code>ffmpeg</code></td><td>Pre-installed FFmpeg image for generating thumbnail for local storage</td></tr><tr><td style="text-align:left;"><code>aria2</code></td><td>Pre-installed aria2 image for offline downloading.</td></tr></tbody></table><p>You can append a suffix using the <code>-</code> symbol after any of the mirror tags to switch to an image with the corresponding environment. For example, <code>xhofe/alist:latest-aio</code> <code>xhofe/alist:beta-aria2</code> <code>xhofe/alist:v3.40.0-ffmpeg</code></p><p>If the thumbnail generation function still does not work when using the pre-installed ffmpeg, please confirm:</p><ul><li>You are using local storage</li><li>Switched to grid view</li><li>The thumbnail switch in local storage driver settings is enabled</li><li>The configuration path for the thumbnail cache folder in local storage is correct, for example, <code>data/thumbnail</code></li></ul><p>When using a pre-installed aria2 mirror, you might see errors like the following in the alist logs:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ERRO[2022-11-20 12:05:19] error [unaligned 64-bit atomic operation] while run task  [download http://xxx.com/xxx.png to [/ftp](/)]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The solution is, if the CPU architecture is 64-bit, you can try to manually pull a 64-bit image or rebuild the container. If the CPU architecture is 32-bit, there is currently no available solution.</p><h2 id="see-the-admin-s-info" tabindex="-1"><a class="header-anchor" href="#see-the-admin-s-info" aria-hidden="true">#</a> See the admin&#39;s info:</h2><h4 id="lower-than-v3-25-0" tabindex="-1"><a class="header-anchor" href="#lower-than-v3-25-0" aria-hidden="true">#</a> Lower than v3.25.0</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> alist ./alist admin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="higher-than-v3-25-0" tabindex="-1"><a class="header-anchor" href="#higher-than-v3-25-0" aria-hidden="true">#</a> Higher than v3.25.0</h4><p>Versions above 3.25.0 change the password to an encrypted hash value, and the password cannot be calculated directly. If the password is forgotten, it can only be re-<strong><code>randomly generated</code></strong> or <strong><code>manually set</code></strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Randomly generate a password</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> alist ./alist admin random
<span class="token comment"># Manually set a password, \`NEW_PASSWORD\` refers to the password you need to set</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> alist ./alist admin <span class="token builtin class-name">set</span> NEW_PASSWORD
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="update" tabindex="-1"><a class="header-anchor" href="#update" aria-hidden="true">#</a> <strong>Update</strong></h2><details class="hint-container details"><summary>docker-cli update</summary><ol><li>docker ps -a #View the container (find the ID of the Alist container)</li><li>docker stop ID #Stop Alist running, otherwise it cannot be deleted (this time the ID of the Alist container is d429749a6e69, it is different for each installation)</li><li>docker rm ID #Delete the Alist container (the data is still there as long as you don&#39;t delete it manually)</li><li>docker pull xhofe/alist:latest</li><li><a href="#docker-cli">Enter the installation command and click to view</a></li><li>The update is complete, go and have a look.. It&#39;s that simple</li></ol><p><strong>There is a missing step in the picture, it is step 4 in the tutorial....remember to execute</strong><br><img src="`+c+'" alt="docker"></p></details><details class="hint-container details"><summary>docker-compose update</summary><ol><li><p>docker-compose pull</p></li><li><p>docker-compose up -d</p></li></ol></details><p>Q: My version is v3.x.x and I cannot upgrade to the latest version. <code>docker pull xhofe/alist:latest</code> does not work to pull the latest version. After changing to docker-compose, it is still version 3.x.x</p><p>A: The reason is that your docker has set up a mirror, and the latest version cannot be updated from the mirror, so modify /etc/docker/daemon.json and delete &quot;registry-mirrors&quot;: [&quot;mirror accelerator address&quot;]</p><ul><li>If deletion doesn’t work, you can consider replacing it with a <code>mirror acceleration address</code></li><li>Or simple and rude: when downloading, replace <code>xhofe/alist:latest</code> with <code>xhofe/alist:v3.16.3</code> (specify the version, the latest when writing the tutorial is 3.16.3)</li></ul><h3 id="compile-image" tabindex="-1"><a class="header-anchor" href="#compile-image" aria-hidden="true">#</a> <strong>Compile Image</strong></h3><p>Install Docker, clone the repository, then navigate to the root directory of the repository. No further preparation is required.</p>',23),U=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[e("pre",{class:"language-bash"},[e("code",null,[e("span",{class:"token function"},"docker"),a(" build "),e("span",{class:"token parameter variable"},"-t"),a(" xhofe/alist:latest "),e("span",{class:"token builtin class-name"},"."),a(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),P=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh"},[e("pre",{class:"language-bash"},[e("code",null,[e("span",{class:"token function"},"docker"),a(" build "),e("span",{class:"token parameter variable"},"-t"),a(" xhofe/alist:latest-ffmpeg --build-arg "),e("span",{class:"token assign-left variable"},"INSTALL_FFMPEG"),e("span",{class:"token operator"},"="),a("true "),e("span",{class:"token builtin class-name"},"."),a(`
`)])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"})])],-1),T=i('<p>Available build args:</p><table><thead><tr><th style="text-align:left;"></th><th>Desc</th></tr></thead><tbody><tr><td style="text-align:left;"><code>INSTALL_FFMPEG=true</code></td><td>Install ffmpeg</td></tr><tr><td style="text-align:left;"><code>INSTALL_ARIA2=true</code></td><td>Install aria2</td></tr></tbody></table>',2);function N(E,L){const o=r("ExternalLinkIcon"),d=r("Tabs");return u(),h("div",null,[g,e("table",null,[v,e("tbody",null,[b,f,e("tr",null,[k,x,e("td",null,[e("a",y,[a("https://en.wikipedia.org/wiki/Umask"),l(o)])])]),_,w])]),I,A,e("p",null,[a("Latest image version, please refer to "),e("a",D,[a("https://hub.docker.com/r/xhofe/alist/tags"),l(o)])]),S,l(d,{id:"269",data:[{id:"basic"},{id:"build-arg"}],"tab-id":"Docker-build"},{title0:t(({value:s,isActive:n})=>[a("basic")]),title1:t(({value:s,isActive:n})=>[a("build-arg")]),tab0:t(({value:s,isActive:n})=>[U]),tab1:t(({value:s,isActive:n})=>[P]),_:1}),T])}const F=p(m,[["render",N],["__file","docker.html.vue"]]);export{F as default};
